<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../CSS/style.css">
    <script type="text/javascript" src="../JS/user-input.js"></script>
    <script type="text/javascript" src="../JS/user-input.js"></script>
</head>
<body>
    <header>
        <div class="title">
            <h1>Flowdle 2.0</h1>
        </div>
    </header>
    <main>
        <div class="difficulty-container">
            <h2>Select a difficulty</h2>
            <div class="difficulty-buttons">
                <button onclick="usrInput()">Easy</button>
                <button>Hard</button>
                <button>Infinite</button>
            </div>
        </div>

        <div class="words-container">
            <div class="row" id="row1">
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
            </div>
            <div class="row" id="row2">
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
            </div>
            <div class="row" id="row3">
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
            </div>
            <div class="row" id="row4">
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
            </div>
            <div class="row" id="row5">
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
            </div>

            <script>
				//Arrays of words being used for our game
				const words = ["apply","amoks","abuzz","axile","admix","brock","blank","booze","bezil","craze","comfy","crock","cajon","cheek","dixie","decoy","doozy","djinn","detox","evade","extra","envoy","empty","exams","fluff","field","flask","fruit","flair","gauze","genre","glyph","graze","guilt","habit","hoist","hover","hydro","harpy","indie","ivory","ionic","idyll","input","joust","juicy","juror","jokes","jewel","karma","knave","kodak","kanji","kinky","latch","lemon","lured","lymph","lyric","macro","marsh","menus","mixer","mogul","navel","niche","nymph","nexus","nails"];
                // get the boxes that hold the letters
                let row1 = document.getElementById('row1').getElementsByClassName('letter');
                let row2 = document.getElementById('row2').getElementsByClassName('letter');
                let row3 = document.getElementById('row3').getElementsByClassName('letter');
                let row4 = document.getElementById('row4').getElementsByClassName('letter');
                let row5 = document.getElementById('row5').getElementsByClassName('letter');
                let rows = [row1, row2, row3, row4, row5];
                
                let randomLetter = words[Math.floor(Math.random() * words.length)];
                console.log(randomLetter);

                // prevent the user from entering more than 5 characters at a time
                let index = 0;
                let rowIndex = 0;

                // if (index < 5) {
                //     document.body.addEventListener('keypress', (key) => {
                //         let row = rows[rowIndex];
                //         // check if the input is a valid character
                //         if (((key.charCode > 64 && key.charCode < 91) || (key.charCode > 96 && key.charCode < 123)) && index < row.length) {
                //             // set the current square's text to the inputted character
                //             row[index].innerHTML = key.key;
                //             index += 1;
                //         }
                //         // delete
                //         else if (key.charCode == 8 && index > 0) {
                //             // if the user enters a backspace, go to the previous square and remove the character in it
                //             index -= 1;
                //             row[index].innerHTML = "";
                //         }
                //         // check row when filled in
                //         else if (key.charCode == 13 && index == 5) {
                //             checkValid(row);
                //             rowIndex += 1;
                //             index = 0;
                //             if (rowIndex == 5) {
                //                 document.body.removeEventListener('keypress', this);
                //             }
                //         }
                //     });
                // }

                function getInput(key) {
                    let row = rows[rowIndex];
                    // check if the input is a valid character
                    if (((key.charCode > 64 && key.charCode < 91) || (key.charCode > 96 && key.charCode < 123)) && index < row.length) {
                        // set the current square's text to the inputted character
                        row[index].innerHTML = key.key.toUpperCase();
                        index += 1;
                    }
                    // delete
                    else if (key.charCode == 8 && index > 0) {
                        // if the user enters a backspace, go to the previous square and remove the character in it
                        index -= 1;
                        row[index].innerHTML = "";
                    }
                    // check row when filled in
                    else if (key.charCode == 13 && index == 5) {
                        let sameWord = checkValid(row);
                        rowIndex += 1;
                        index = 0;
                        if (rowIndex == 5 || sameWord) {
                            document.body.removeEventListener('keypress', getInput);
                        }
                    }
                }

                function checkValid(letters) {
                    // check if letter is in right spot
                    // check if letter is in the random letter
                    // row[i].style.backgroundColor = 'rgba(69, 41, 113, 0.75)';
                    for (let i = 0; i < letters.length; i++) {
                        if (letters[i].innerHTML == randomLetter[i].toUpperCase()) {
                            letters[i].style.backgroundColor = 'rgba(69, 41, 113, 0.75)';
                            letters[i].style.color = 'white';
                        }
                        if (letters.innerHTML == randomLetter.toUpperCase()) {
                            return true;
                        }
                        for (let j = 0; j < randomLetter.length; j++) {
                            if (letters[i].innerHTML == randomLetter[j].toUpperCase() && i != j) {
                                letters[i].style.backgroundColor = 'rgba(241, 181, 14, 0.5)';
                                letters[i].style.color = 'white';
                            }
                        }
                    }
                    return false;
                }
                
                if (index < 5) {
                    document.body.addEventListener('keypress', (key) => getInput(key));
                }
                
            </script>
        </div>
    </main>
    <footer></footer>
</body>
</html>